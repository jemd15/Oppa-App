<ion-content class="bicolor">
  <ion-button class="close-btn" (click)="closeModal()">
    <ion-icon size="large" slot="icon-only" name="close"></ion-icon>
  </ion-button>
  <ion-img class="header-img" [src]="service.img"></ion-img>
  <ion-card class="ion-margin-horizontal ion-padding-horizontal">
    <form [formGroup]="scheduleServiceForm" (ngSubmit)="scheduleService()" ngNativeValidate>
      <ion-list lines="none">
        <ion-list-header class="ion-no-padding">
          <ion-grid class="ion-no-padding">
            <ion-row class="ion-no-padding">
              <ion-col class="ion-text-center ion-no-padding" size="12">
                <h1 class="ion-no-margin ion-margin-top"><ion-label color="secondary"><strong>{{ service.name | titlecase }}</strong></ion-label></h1>
              </ion-col>
              <ion-col class="ion-text-center ion-no-padding" size="12">
                <h3 class="ion-no-margin"><ion-text>${{ service.price | number }}</ion-text></h3>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-list-header>
        <ion-item>
          <ion-icon name="calendar-outline" slot="start"></ion-icon>
          <ion-label>Fecha</ion-label>
          <ion-datetime cancelText="cancelar"
                        placeholder="Ingrese Fecha"
                        doneText="aceptar"
                        displayFormat="DD-MM-YYYY"
                        monthShortNames="ene, feb, mar, abr, may, jun, jul, ago, sep, oct, nov, dic"
                        [min]="minDate"
                        formControlName="date"
                        (ionChange)="setMinHour()"></ion-datetime>
        </ion-item>
        <ion-item>
          <ion-icon name="time-outline" slot="start"></ion-icon>
          <ion-label>Hora</ion-label>
          <ion-datetime displayFormat="HH:mm"
                        placeholder="Ingrese Hora"
                        [min]="minHour"
                        cancelText="cancelar"
                        formControlName="hour"
                        doneText="aceptar"></ion-datetime>
        </ion-item>
        <ion-item>
          <ion-icon name="timer-outline" slot="start"></ion-icon>
          <ion-label>Flexibilidad Horaria</ion-label>
          <ion-select interface="action-sheet"
                      [interfaceOptions]="ActionSheetOptionsFlexibility"
                      formControlName="flexibility"
                      placeholder="Seleccionar"
                      cancelText="Cancelar">
            <ion-select-option>No</ion-select-option>
            <ion-select-option>± 30 min.</ion-select-option>
            <ion-select-option>± 1 hr.</ion-select-option>
          </ion-select>
        </ion-item>
        <ion-item>
          <ion-icon name="person-outline" slot="start"></ion-icon>
          <ion-label>Adulto Mayor</ion-label>
          <ion-select interface="action-sheet"
                      [interfaceOptions]="ActionSheetOptionsElder"
                      placeholder="Seleccionar"
                      formControlName="elder"
                      cancelText="Cancelar">
            <ion-select-option *ngFor="let elder of user?.elders">{{ elder.firstname + ' ' + elder.lastname }}</ion-select-option>
          </ion-select>
        </ion-item>
        <ion-list-header>
          <h3>Dirección</h3>
        </ion-list-header>
        <ion-radio-group formControlName="address">
          <ion-item *ngFor="let location of user.locations" class="ion-text-wrap">
            <ion-radio slot="start" [value]="location.street + '|' + location.other  + '|' + location.district + '|' + location.region"></ion-radio>
            <ion-label>{{ location.street + ', ' + location.district + ', ' + location.region + '.' }}</ion-label>
          </ion-item>
        </ion-radio-group>
        <ion-button class="ion-padding-horizontal" expand="block" color="secondary" (click)="addLocation()">Agregar Dirección</ion-button>
        <ng-template hidden>
          <ion-item>
            <ion-label>Calle</ion-label>
            <ion-input formControlName="street" type="text" placeholder="Calle, Avenida, Pasaje..." required></ion-input>
          </ion-item>
          <ion-item>
            <ion-label></ion-label>
            <ion-input type="text" placeholder="Dpto., Suite, Block... (opcional)"></ion-input>
          </ion-item>
          <ion-item>
            <ion-label>Región</ion-label>
            <ion-select interface="action-sheet"
                        [interfaceOptions]="ActionSheetOptionsRegions"
                        placeholder="Seleccionar"
                        formControlName="region"
                        cancelText="Cancelar"
                        (ionChange)="getDistrictsByRegion()">
              <ion-select-option *ngFor="let region of $regions | async" [value]="region.codigo">{{ region.nombre }}</ion-select-option>
            </ion-select>
          </ion-item>
          <ion-item>
            <ion-label>Comúna</ion-label>
            <ion-select [disabled]="(scheduleServiceForm.value.region === null)"
                        interface="action-sheet"
                        [interfaceOptions]="ActionSheetOptionsDistricts"
                        placeholder="Seleccionar"
                        formControlName="district"
                        cancelText="Cancelar">
              <ion-select-option *ngFor="let district of $districts | async" [value]="district.codigo">{{ district.nombre }}</ion-select-option>
            </ion-select>
          </ion-item>
        </ng-template>
        <ion-list-header>
          <h3>Método de Pago</h3>
        </ion-list-header>
        <ion-radio-group>
          <ion-item class="ion-text-wrap">
            <ion-radio [disabled]="service.price > user.credit" slot="start" value="wallet"></ion-radio>
            <ion-label>Monedero: ${{user.credit | number}}</ion-label>
          </ion-item>
          <ion-item class="ion-text-wrap">
            <ion-radio slot="start" value="credit-card"></ion-radio>
            <ion-label>Tajeta de Crédito/Débito (webpay)</ion-label>
          </ion-item>
        </ion-radio-group>
        <ion-button class="ion-padding-horizontal" expand="block" color="light" (click)="closeModal()">cancelar</ion-button>
        <ion-button class="ion-padding-horizontal" expand="block" color="primary" type="submit">solicitar</ion-button>
      </ion-list>
    </form>
  </ion-card>
</ion-content>